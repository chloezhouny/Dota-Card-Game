<!DOCTYPE html>
<html>
<head>
	<title>RPG Game</title>
	
    <link rel="stylesheet" href="assets/css/reset.css">

    <link rel="stylesheet" href="assets/css/style.css">

</head>
<body>
	<header>
		RPG Game!
	</header>

	<main>
		<div id = "selectArea">
			<h3>Your character</h3>
			<div>
				<button id = "c0" class = "character" value = "0" width=150px>
					<img src = "assets/images/chaos.gif">
					<br><span id ="score0"></span>
				</button>
			</div>
			<div>
				<button id = "c1" class = "character" value = "1" width =150px>
					<img src = "assets/images/invoker.gif" >
					<br><span id= "score1"></span>
				</button>
			</div>
			<div>
				<button id = "c2" class = "character" value = "2" width=150px>
					<img src = "assets/images/dp.gif" >
					<br><span id= "score2"></span>
				</button>
			</div>
			<div>
				<button id = "c3" class = "character" value = "3" width=150px>
					<img src = "assets/images/enigma.gif">
					<br><span id= "score3"></span>
				</button>
			</div>
		</div>

		<div id = "enemiesDiv">
			<h3>Enemies available to attack</h3>
			<div id = "enemiesArea" width = "600px">
			</div>
		</div>

		<div id = "defenderDiv">
			<h3 >Defender</h3>
			<div id = "defenderArea" ></div>
		</div>


		<div>
			<h3>Fight Section</h3>
			<button id="attack">Attack</button>
		</div>
		<div id= "resultArea">
		</div>


	</main>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script>
		var myCharacter;
		var myCharacterScore;
		var myCharacterPicked = 0;
		var defender = "";
		var defeatedCount = 0;
		var defenderPicked = 0;
		

		var c0 = 
		{
			name: "one",
			healthPoint: 100,
			attackPower: 5,
			counterPower: 5,
			defeatedStatus: false,
			id: "#c0",

			scoreId: "#score0"
		}

		var c1 = 
		{
			name: "two",
			healthPoint: 100,
			attackPower: 5,
			counterPower: 5,
			defeatedStatus: false,
			id: "#c1",
			scoreId: "#score1"
		}

		var c2 = 
		{
			name: "three",
			healthPoint: 100,
			attackPower: 5,
			counterPower: 5,
			defeatedStatus: false,
			id: "#c2",
			scoreId: "#score2"
		}

		var c3 = 
		{
			name: "four",
			healthPoint: 100,
			attackPower: 5,
			counterPower: 5,
			defeatedStatus: false,
			id: "#c3",
			scoreId: "#score3"
		}


		var characterArr = [c0, c1, c2, c3];
		for (var i = 0; i < characterArr.length; i++)
		{
			$(characterArr[i].scoreId).html("<br>" + characterArr[i].healthPoint);
		}



		$(".character").on("click", function()
		{
			if (myCharacterPicked === 0)
			{
				myCharacter = parseInt($(this).val());
				for (var i = 0; i < characterArr.length; i ++)
				{
					if (i !== myCharacter) {
						$("#enemiesArea").append($(characterArr[i].id));
						$(characterArr[i].id).attr("width", "33.3%")

					}
				}
				myCharacterPicked = 1;
			}

			else if (parseInt($(this).val())!== myCharacter && defenderPicked === 0)
			{

				defender = parseInt($(this).val());
				$("#defenderArea").html($(this));
				$(this).attr("width", "400px")
				defenderPicked ++;
			}
		})

		$("#attack").on("click", function()
		{
			if(characterArr[defender].defeatedStatus === true && defeatedCount < 3)
			{
				$("#resultArea").html("No enemy to attack");
			}
			if(characterArr[defender].healthPoint > 0 && characterArr[myCharacter].healthPoint > 0)
			{
				$("#resultArea").html("");
				characterArr[myCharacter].healthPoint -= characterArr[defender].counterPower;
				characterArr[defender].healthPoint -= characterArr[myCharacter].attackPower;
				

				$(characterArr[myCharacter].scoreId).html("<br>" + characterArr[myCharacter].healthPoint);
				$(characterArr[defender].scoreId).html("<br>" + characterArr[defender].healthPoint);


				if(characterArr[defender].healthPoint > 0 && characterArr[myCharacter].healthPoint > 0)
				{
					$("#resultArea").append("<h3> You attacked " + characterArr[defender].name + " for " + characterArr[myCharacter].attackPower + " damage. <br>");
					$("#resultArea").append(characterArr[defender].name + " attacked you back for " + characterArr[defender].counterPower+ " damage. ")
				}


				if(characterArr[defender].healthPoint < 0 && defeatedCount < 3)
				{
					console.log(characterArr[defender].defeatedStatus);
					$("#resultArea").append("<h3> You have defeated " + characterArr[defender].name + ", you can choose to fight another enemy");
					$("#defenderArea").html("");
					characterArr[defender].defeatedStatus = true;
					defeatedCount ++;
					defenderPicked = 0;
					if(defeatedCount >= 3)
					{
						$("#resultArea").html("Your won! !! Game over!!");
					}
				}

				characterArr[myCharacter].attackPower += characterArr[myCharacter].attackPower;
			}
/*
			if(characterArr[defender].defeatedStatus === true)
			{
				$("#resultArea").html("No enemy to attack");
			}
*/

		})

	</script>


</body>
</html>